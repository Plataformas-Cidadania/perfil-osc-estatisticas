# Mercado de Trabalho das OSCs {#cap-mercadotrab}

```{r setup cap mercadotrab, echo=FALSE, warning=FALSE, message=FALSE}
library(gt)
library(tidyverse)
library(ggplot2)
library(scales)
```

Neste capítulo são apresentados dados sobre o mercado formal de trabalho nas Organizações da Sociedade Civil - OSCs a partir de dados da Relação Anual de Informações Sociais (Rais). Para isto foram utilizados dois grupos: os vínculos empregatícios e o pessoal ocupado. Não há dados disponíveis na Rais sobre os trabalhadores voluntários,1 razão pela qual estão excluídos desta análise. Espera-se que o voluntariado constitua uma fração relevante da força de trabalho nas OSCs, e, por isso, os números aqui apresentados subestimam o número total de pessoas que efetivamente atuam em ações associadas às OSCs. Ademais, é de se registrar que os dados da Rais indicam apenas os vínculos formais de trabalho, e, tal como em outros setores da economia, a fração de trabalhadores que exercem funções autônomas sem vinculação formal ao empregador pode ser expressiva.


&nbsp;

*Tabela 7.1 - Total e percentual do pessoal ocupado em empregos formais das OSCs por região e  Unidades da Federação.* 

```{r table Join_NVinc_OSC, echo=FALSE, warning=FALSE}

Join_NVinc_OSC <- readRDS("tables/Join_NVinc_OSC.RDS")

# Formata tabela:
# Tabela Inteira:
Join_NVinc_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, UF_Ordem)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeRegUF = "Região geográfica",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeRegUF )
  ) %>%
  
  # Torna as regiões mais destacadas
  tab_style(
  style = cell_text(indent = px(20)), # Intentação
  locations = cells_body(
    columns = NomeRegUF,
    rows = Agregacao ==  "UF")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (regiões) em negrito
    locations = cells_body(
      rows = Agregacao !=  "UF")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Gráfico 7.1 - Total e percentual do pessoal ocupado em empregos formais das OSCs por região e  Unidades da Federação* 

```{r plot GrafData_NVincReg_OSC, fig.height = 4, fig.width = 7, echo=FALSE, warning=FALSE}

GrafData_NVincReg_OSC <- readRDS("tables/GrafData_NVincReg_OSC.RDS")


# Gera Gráfico:
GrafData_NVincReg_OSC %>%
  ggplot(aes(x = NomeRegUF)) +

  geom_bar(aes(y = Soma_Vinculos), stat = "identity", fill = "blue3") +
  geom_text(
    aes(
      label = format(Soma_Vinculos, big.mark = ".",
                     decimal.mark = ",",
                     scientific = FALSE),
      y = Soma_Vinculos
    ),
    position = position_dodge(width=0.9),
    vjust=-0.25,
    hjust = 1.1) +

  geom_point(aes(y = PerVinculos * 17000), color = "red", size = 3) +
  geom_label(
    aes(
      y = PerVinculos * 17000,
      label = format(round(PerVinculos, 1),
                     big.mark = ".",
                     decimal.mark = ",",
                     scientific = FALSE)
    ),
    fill = "pink",
    label.size = 0,
    position = position_dodge(width=0.9),
    vjust = 0.25,
    hjust = -0.2) +

  theme_classic() +

  scale_y_continuous(
    labels = function(x) format(x, big.mark = ".",
                                decimal.mark = ",",
                                scientific = FALSE),
    # Features of the first axis
    name = "Pessoal Ocupado",

    # Add a second axis and specify its features
    sec.axis = sec_axis(~./17000, name="Porcentagem do Total (%)")
    ) +

  theme(
    axis.title.x = element_blank(),
  )



```



&nbsp;

*Tabela 7.2 - Pessoal Ocupado por Área de Atuação - Geral* 

```{r table Join_NVincAreaSubArea_OSC, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC <- readRDS("tables/Join_NVincAreaSubArea_OSC.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```

&nbsp;

*Tabela 7.3 - Pessoal Ocupado por Área de Atuação - Região Norte* 

```{r table Join_NVincAreaSubArea_OSC_N, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC_N <- readRDS("tables/Join_NVincAreaSubArea_OSC_N.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC_N %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.4 - Pessoal Ocupado por Área de Atuação - Região Nordeste* 

```{r table Join_NVincAreaSubArea_OSC_NE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC_NE <- readRDS("tables/Join_NVincAreaSubArea_OSC_NE.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC_NE %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.5 - Pessoal Ocupado por Área de Atuação - Região Centro-Oeste* 

```{r table Join_NVincAreaSubArea_OSC_CO, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC_CO <- readRDS("tables/Join_NVincAreaSubArea_OSC_CO.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC_CO %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.6 - Pessoal Ocupado por Área de Atuação - Região Sudeste* 

```{r table Join_NVincAreaSubArea_OSC_SE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC_SE <- readRDS("tables/Join_NVincAreaSubArea_OSC_SE.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC_SE %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```



&nbsp;

*Tabela 7.7 - Pessoal Ocupado por Área de Atuação - Região Sul* 

```{r table Join_NVincAreaSubArea_OSC_S, echo=FALSE, warning=FALSE}

Join_NVincAreaSubArea_OSC_S <- readRDS("tables/Join_NVincAreaSubArea_OSC_S.RDS")

# Formata tabela:
Join_NVincAreaSubArea_OSC_S %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Freq = "N",
    PerFreqOSC = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Freq, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerFreqOSC, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "OSCs",
    columns = c(Freq, PerFreqOSC)
  ) %>%

  tab_spanner(
    label = "Pessoal ocupado",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerFreqOSC, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```



&nbsp;

*Gráfico 7.2 - Faixa etária e sexo do pessoal ocupado - Geral* 

```{r plot GrafIdadeSexo, echo=FALSE, warning=FALSE}

GrafIdadeSexo <- readRDS("tables/GrafIdadeSexo.RDS")

# Gera Gráfico:
GrafIdadeSexo %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  # theme_classic() +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )



```


&nbsp;

*Gráfico 7.3 - Faixa etária e sexo do pessoal ocupado - Assistencia Social* 

```{r plot GrafIdadeSexo_AS, echo=FALSE, warning=FALSE}

GrafIdadeSexo_AS <- readRDS("tables/GrafIdadeSexo_AS.RDS")

# Gera Gráfico:
GrafIdadeSexo_AS %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  # theme_classic() +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )


```



&nbsp;

*Gráfico 7.4 - Faixa etária e sexo do pessoal ocupado - Educação* 

```{r plot GrafIdadeSexo_ED, echo=FALSE, warning=FALSE}

GrafIdadeSexo_ED <- readRDS("tables/GrafIdadeSexo_ED.RDS")

# Gera Gráfico:
GrafIdadeSexo_ED %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )

```


&nbsp;

*Gráfico 7.5 - Faixa etária e sexo do pessoal ocupado - Defesa de Direitos* 

```{r plot GrafIdadeSexo_DD, echo=FALSE, warning=FALSE}

GrafIdadeSexo_DD <- readRDS("tables/GrafIdadeSexo_DD.RDS")

# Gera Gráfico:
GrafIdadeSexo_DD %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )

```

&nbsp;

*Gráfico 7.6 - Faixa etária e sexo do pessoal ocupado - Religião* 

```{r plot GrafIdadeSexo_RL, echo=FALSE, warning=FALSE}

GrafIdadeSexo_RL <- readRDS("tables/GrafIdadeSexo_RL.RDS")

# Gera Gráfico:
GrafIdadeSexo_RL %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )


```


&nbsp;

*Gráfico 7.7 - Faixa etária e sexo do pessoal ocupado - Saúde* 

```{r plot GrafIdadeSexo_SD, echo=FALSE, warning=FALSE}

GrafIdadeSexo_SD <- readRDS("tables/GrafIdadeSexo_SD.RDS")

# Gera Gráfico:
GrafIdadeSexo_SD %>%
  ggplot(aes(x = Per, y = FaixaEtaria, fill = sexo)) +
  geom_col() +
  scale_x_continuous(labels = scales::percent) +
  ylab("Grupo Etário") +
  theme(
    legend.title = element_blank()
  )


```

&nbsp;

*Tabela 7.8 - Total e percentual do pessoal ocupado em empregos formais das OSCs das Grandes  Regiões e Unidades da Federação, por sexo* 


```{r table Join_NVincSex_OSC, echo=FALSE, warning=FALSE}

Join_NVincSex_OSC <- readRDS("tables/Join_NVincSex_OSC.RDS")

# Formata tabela: 
# Tabela Inteira:
Join_NVincSex_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, UF_Ordem)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeRegUF = "Região geográfica",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeRegUF )
  ) %>%

  # Torna as regiões mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeRegUF,
      rows = Agregacao ==  "UF")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (regiões) em negrito
    locations = cells_body(
      rows = Agregacao !=  "UF")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%

  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%
  
  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(PerVinculos_f, PerVinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```


&nbsp;

*Tabela 7.9 - Pessoal Ocupado por área de atuação e sexo  - Geral* 

```{r table Join_NVincAreaSubAreaSex_OSC, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC.RDS")

# Formata tabela:
# Tabela Inteira:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC %>%
  gt(locale = "pt-BR") %>%
  
  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%
  
  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%
  
  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  
  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%
  
  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%
  
  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%
  
  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%
  
  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%
  
  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%
  
  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%
  
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%
  
  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```

&nbsp;

*Tabela 7.10 - Pessoal Ocupado por área de atuação e sexo  - Nordeste* 

```{r table Join_NVincAreaSubAreaSex_OSC_NE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC_NE <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC_NE.RDS")

# Formata tabela:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC_NE %>%
  gt(locale = "pt-BR") %>%
  
  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%
  
  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%
  
  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  
  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%
  
  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%
  
  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%
  
  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%
  
  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%
  
  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%
  
  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%
  
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%
  
  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```

&nbsp;

*Tabela 7.11 - Pessoal Ocupado por área de atuação e sexo  - Norte* 

```{r table Join_NVincAreaSubAreaSex_OSC_N, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC_N <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC_N.RDS")

# Formata tabela:
# Tabela Inteira:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC_N %>%
  gt(locale = "pt-BR") %>%
  
  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%
  
  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%
  
  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  
  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%
  
  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%
  
  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%
  
  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%
  
  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%
  
  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%
  
  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%
  
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%
  
  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```

&nbsp;

*Tabela 7.12 - Pessoal Ocupado por área de atuação e sexo  - Centro-Oeste* 

```{r table Join_NVincAreaSubAreaSex_OSC_CO, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC_CO <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC_CO.RDS")

# Formata tabela:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC_CO %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%

  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%

  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```

&nbsp;

*Tabela 7.13 - Pessoal Ocupado por área de atuação e sexo  - Sudeste* 

```{r table Join_NVincAreaSubAreaSex_OSC_SE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC_SE <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC_SE.RDS")

# Formata tabela:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC_SE %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%

  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%

  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```

&nbsp;

*Tabela 7.14 - Pessoal Ocupado por área de atuação e sexo  - Sul* 

```{r table Join_NVincAreaSubAreaSex_OSC_S, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaSex_OSC_S <- readRDS("tables/Join_NVincAreaSubAreaSex_OSC_S.RDS")

# Formata tabela:
# Tabela Inteira:
Join_NVincAreaSubAreaSex_OSC_S %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade",
    Soma_Vinculos_f = "N",
    PerVinculos_f = "(%)",
    Soma_Vinculos_m = "N",
    PerVinculos_m = "(%)",
    Soma_Vinculos = "N",
    PerVinculos = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_f, Soma_Vinculos_m, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(PerVinculos_f, PerVinculos_m, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Homem",
    columns = c(Soma_Vinculos_f, PerVinculos_f)
  ) %>%

  tab_spanner(
    label = "Mulher",
    columns = c(Soma_Vinculos_m, PerVinculos_m)
  ) %>%

  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Soma_Vinculos_f, Soma_Vinculos_m, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```

&nbsp;

*Tabela 7.15 - Vínculos por Raça e Região - Tabela 1* 

```{r table Join_NVincRaca_OSC, echo=FALSE, warning=FALSE}

Join_NVincRaca_OSC <- readRDS("tables/Join_NVincRaca_OSC.RDS")

# Formata tabela:
Join_NVincRaca_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Soma_Vinculos_branco, Per_Vinculos_branco,
              Soma_Vinculos_preto, Per_Vinculos_preto,
              Soma_Vinculos_pardo, Per_Vinculos_pardo,
              Agregacao, UF_Ordem)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeRegUF = "Região geográfica",

    Soma_Vinculos_indigena = "N",
    Per_Vinculos_indigena = "Representatividade (%)",
    Soma_Vinculos_amarelo = "N",
    Per_Vinculos_amarelo = "Representatividade (%)",

    Soma_Vinculos = "N",
    PerVinculos = "Representatividade (%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_indigena, Soma_Vinculos_amarelo, Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_indigena, Per_Vinculos_amarelo, PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeRegUF )
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Amarelo",
    columns = c(Soma_Vinculos_amarelo, Per_Vinculos_amarelo)
  ) %>%

  tab_spanner(
    label = "Indígena",
    columns = c(Soma_Vinculos_indigena, Per_Vinculos_indigena)
  ) %>%


  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_amarelo, Per_Vinculos_indigena, PerVinculos)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.16 - Vínculos por Raça e Região - Tabela 2* 

```{r table Join_NVincRaca_OSC_2, echo=FALSE, warning=FALSE}

Join_NVincRaca_OSC <- readRDS("tables/Join_NVincRaca_OSC.RDS")

# Formata tabela:
Join_NVincRaca_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Soma_Vinculos_indigena, Per_Vinculos_indigena,
              Soma_Vinculos_amarelo, Per_Vinculos_amarelo,
              Agregacao, UF_Ordem)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeRegUF = "Região geográfica",

    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "Representatividade (%)",
    Soma_Vinculos_preto = "N",
    Per_Vinculos_preto = "Representatividade (%)",
    Soma_Vinculos_pardo = "N",
    Per_Vinculos_pardo = "Representatividade (%)",

    Soma_Vinculos = "N",
    PerVinculos = "Representatividade (%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_preto, Soma_Vinculos_pardo,
                Soma_Vinculos),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_preto, Per_Vinculos_pardo,
                PerVinculos),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeRegUF )
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Branco",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Preto",
    columns = c(Soma_Vinculos_preto, Per_Vinculos_preto)
  ) %>%

  tab_spanner(
    label = "Pardo",
    columns = c(Soma_Vinculos_pardo, Per_Vinculos_pardo)
  ) %>%

  tab_spanner(
    label = "Total",
    columns = c(Soma_Vinculos, PerVinculos)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_preto, Per_Vinculos_pardo)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.17 - Total e percentual de pessoal ocupado em empregos formais em Grandes Regiões e  Unidades da Federação, por raça* 

```{r table Join_NVincUFRegRaca_OSC, echo=FALSE, warning=FALSE}

Join_NVincUFRegRaca_OSC <- readRDS("tables/Join_NVincUFRegRaca_OSC.RDS")

# Formata tabela:
# Tabela inteira:
Join_NVincUFRegRaca_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, UF_Ordem)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeRegUF = "Região geográfica",

    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeRegUF )
  ) %>%

  # Torna as regiões mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeRegUF,
      rows = Agregacao ==  "UF")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (regiões) em negrito
    locations = cells_body(
      rows = Agregacao !=  "UF")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.18 - Total e percentual de pessoal ocupado em empregos formais em Grandes Regiões e  Unidades da Federação, por raça* 


```{r table Join_NVincAreaSubAreaRaca_OSC, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC.RDS")

# Tabela Inteira:
Join_NVincAreaSubAreaRaca_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Gráfico 7.8 - Total e percentual de pessoal ocupado em empregos formais, por finalidades de  atuação e raça* 


```{r Plot Join_NVincAreaSubAreaRaca_OSC, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC.RDS")

PlotData <- Join_NVincAreaSubAreaRaca_OSC %>%
  dplyr::filter(Agregacao == "Area") %>%
  select(NomeAreaSubArea, Soma_Vinculos_negro, Soma_Vinculos_branco) %>%
  gather("key", "value", Soma_Vinculos_negro:Soma_Vinculos_branco) %>%
  group_by(NomeAreaSubArea) %>%
  mutate(Per_Vinculo = value / sum(value)) %>%
  ungroup() %>%
  mutate(NomeAreaSubArea = fct_inorder(NomeAreaSubArea),
         key = ifelse(key == "Soma_Vinculos_negro", "Negros", "Brancos")
  )

PlotData %>%
  ggplot(aes(x = Per_Vinculo, y = NomeAreaSubArea, fill = key)) +

  geom_col() +
  scale_fill_manual( values = c("blue1","blue4")  ) +
  scale_x_continuous(labels = scales::percent) +
  scale_y_discrete(labels = label_wrap(25)) +
  geom_text(
    aes(
      label = value
      ),
    color="white",
    hjust = ifelse(PlotData$key == "Negros", 1.5, 0)
    ) +
  theme(
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


```


&nbsp;

*Tabela 7.20 - Pessoal Ocupado por área de atuação e raça  - Norte* 

```{r table Join_NVincAreaSubAreaRaca_OSC_N, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC_N <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC_N.RDS")

# Formata tabela:
Join_NVincAreaSubAreaRaca_OSC_N %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%
  
  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.21 - Pessoal Ocupado por área de atuação e raça  - Nordeste* 


```{r table Join_NVincAreaSubAreaRaca_OSC_NE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC_NE <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC_NE.RDS")

# Formata tabela:
Join_NVincAreaSubAreaRaca_OSC_NE %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )

```

&nbsp;

*Tabela 7.22 - Pessoal Ocupado por área de atuação e raça  - Centro-Oeste* 

```{r table Join_NVincAreaSubAreaRaca_OSC_CO, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC_CO <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC_CO.RDS")

# Formata tabela:
Join_NVincAreaSubAreaRaca_OSC_CO %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.23 - Pessoal Ocupado por área de atuação e raça  - Sudeste* 


```{r table Join_NVincAreaSubAreaRaca_OSC_SE, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC_SE <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC_SE.RDS")

# Formata tabela:
Join_NVincAreaSubAreaRaca_OSC_SE %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.24 - Pessoal Ocupado por área de atuação e raça  - Sul* 


```{r table Join_NVincAreaSubAreaRaca_OSC_S, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaRaca_OSC_S <- readRDS("tables/Join_NVincAreaSubAreaRaca_OSC_S.RDS")

# Formata tabela:
Join_NVincAreaSubAreaRaca_OSC_S %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",
    Soma_Vinculos_branco = "N",
    Per_Vinculos_branco = "(%)",
    Soma_Vinculos_negro = "N",
    Per_Vinculos_negro = "(%)",
    Soma_PB = "N",
    Per_PB = "(%)"
  ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(Soma_Vinculos_branco, Soma_Vinculos_negro, Soma_PB),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Brancos",
    columns = c(Soma_Vinculos_branco, Per_Vinculos_branco)
  ) %>%

  tab_spanner(
    label = "Negros",
    columns = c(Soma_Vinculos_negro, Per_Vinculos_negro)
  ) %>%
  
  tab_spanner(
    label = "Totais",
    columns = c(Soma_PB, Per_PB)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_Vinculos_branco, Per_Vinculos_negro, Per_PB)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Tabela 7.25 - Vínculos de pessoas com deficiências por área e UF* 


```{r table Join_NVincAreaSubAreaDef_OSC, echo=FALSE, warning=FALSE}

Join_NVincAreaSubAreaDef_OSC <- readRDS("tables/Join_NVincAreaSubAreaDef_OSC.RDS")

# Formata tabela:
Join_NVincAreaSubAreaDef_OSC %>%
  gt(locale = "pt-BR") %>%

  # Esta coluna não aparece nos dados, só serve para diferenciar as regiões
  cols_hide(c(Agregacao, OrdemArea)) %>%

  # Nomes amigáveis das Colunas
  cols_label(
    NomeAreaSubArea = "Finalidade de atuação",

    CO = "N",
    Per_CO = "(%)",
    N = "N",
    Per_N = "(%)",
    NE = "N",
    Per_NE = "(%)",
    SE = "N",
    Per_SE = "(%)",
    S = "N",
    Per_S = "(%)",
    Total_Soma_Vinculos_Def = "N",
    Per_Total = "(%)"
    ) %>%

  # Deixa o Nome das Colunas em negrito e centralizado.
  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_labels()
  ) %>%

  # Formata os números da tabela
  # Inteiros:
  fmt_number(
    columns = c(CO, N, NE, SE, S, Total_Soma_Vinculos_Def),
    sep_mark = ".",
    decimals = 0
  ) %>%

  # Decimais
  fmt_number(
    columns = c(Per_CO, Per_N, Per_NE, Per_SE, Per_S, Per_Total),
    sep_mark = ".",
    dec_mark = ",",
    decimals = 1
  ) %>%

  # Centraliza os dados das tabelas
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(
      columns = !NomeAreaSubArea )
  ) %>%

  # Torna as Áreas de Atuação mais destacadas
  tab_style(
    style = cell_text(indent = px(20)), # Intentação
    locations = cells_body(
      columns = NomeAreaSubArea,
      rows = Agregacao ==  "SubArea")
  ) %>%
  
  tab_style(
    style = cell_text(weight = "bold"), # Subtotais (Areas) em negrito
    locations = cells_body(
      rows = Agregacao !=  "SubArea")
  ) %>%

  # Cria grupos de variáveis (spanners)
  tab_spanner(
    label = "Centro-Oeste",
    columns = c(CO, Per_CO)
  ) %>%

  tab_spanner(
    label = "Norte",
    columns = c(N, Per_N)
  ) %>%

  tab_spanner(
    label = "Nordeste",
    columns = c(NE, Per_NE)
  ) %>%

  tab_spanner(
    label = "Sudeste",
    columns = c(SE, Per_SE)
  ) %>%

  tab_spanner(
    label = "Sul",
    columns = c(S, Per_S)
  ) %>%

  tab_spanner(
    label = "Total",
    columns = c(Total_Soma_Vinculos_Def, Per_Total)
  ) %>%

  tab_style(
    style = cell_text(align = "center", weight = "bold"),
    locations = cells_column_spanners()
  ) %>%

  # Coloca linha separando Spanners
  tab_style(
    style = cell_borders(
      sides = c("right"),
      style = "dashed",
      weight = px(1)),
    locations = cells_body(
      columns = c(Per_CO, Per_N, Per_NE, Per_SE, Per_S, Per_Total)
    )
  ) %>% 
  
  # Fonte dos dados
  tab_source_note(
    source_note = md("**Nota:** Dados atualizados até Dezembro 2022.<br>
                     **Fonte:** Mapa das Organizações da Sociedade Civil e RAIS (Relação Anual de Informações Sociais).<br>
                     Elaboração do IPEA.")
  )


```


&nbsp;

*Gráfico 7.9 - Percentual de vínculos com deficiência por porte* 

```{r Plot NVincRegDef_OSC, fig.height = 4, fig.width = 7, echo=FALSE, warning=FALSE}

NVincRegDef_OSC <- readRDS("tables/NVincRegDef_OSC.RDS")

# Gera Gráfico:
NVincRegDef_OSC %>%
  ggplot(aes(x = PorteOSC, y = Soma_Vinculos_defic)) +

  geom_bar(stat = "identity", fill = "blue3") +
  geom_text(
    aes(
      label = format(Soma_Vinculos_defic, big.mark = ".",
                     decimal.mark = ",",
                     scientific = FALSE),
      y = Soma_Vinculos_defic
    ),
    position = position_dodge(width=0.9),
    vjust=-0.25,
    hjust = 1.3) +

  geom_point(aes(y = Per_Vinculos_defic * 35000), color = "red", size = 3) +
  geom_label(
    aes(
      y = Per_Vinculos_defic * 35000,
      label = format(round(Per_Vinculos_defic, 1),
                     big.mark = ".",
                     decimal.mark = ",",
                     scientific = FALSE)
    ),
    fill = "pink",
    label.size = 0,
    position = position_dodge(width=0.9),
    vjust = 0.25,
    hjust = -0.2) +

  theme_classic() +

  scale_y_continuous(
    labels = function(x) format(x, big.mark = ".",
                                decimal.mark = ",",
                                scientific = FALSE),
    # Features of the first axis
    name = "Pessoal Ocupado",

    # Add a second axis and specify its features
    sec.axis = sec_axis(~./17000, name="Porcentual do Total (%)")
  ) +

  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(angle = 30, hjust=1)
  )



```

